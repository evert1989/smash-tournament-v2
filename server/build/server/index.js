parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"69WS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ASSET_PATH=exports.ROOT_PATH=void 0;var e=t(require("path"));function t(e){return e&&e.__esModule?e:{default:e}}const r=e.default.resolve(__dirname,"../../");exports.ROOT_PATH=r;const o=`${r}/static`;exports.ASSET_PATH=o;
},{}],"e0q/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PLAYER=exports.GLOBAL=exports.DASHBOARD=void 0;const E={CREATE:"DASHBOARD_CREATE",NEXT_ROUND:"DASHBOARD_NEXT_ROUND",SET_ROUNDS:"DASHBOARD_SET_ROUNDS",SET_WINNER:"DASHBOARD_SET_WINNER"};exports.DASHBOARD=E;const A={RESET:"GLOBAL_RESET",SET_STATE:"GLOBAL_SET_STATE"};exports.GLOBAL=A;const T={ELIMINATED:"PLAYER_ELIMINATED",JOIN:"PLAYER_JOIN",SET_KNOCKOUT_POINTS:"SET_KNOCKOUT_POINTS",UPDATE_POINTS:"PLAYER_UPDATE_POINTS"};exports.PLAYER=T;
},{}],"WjlH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setWinner=exports.setRounds=exports.nextRound=exports.createGame=void 0;var e=require("./actionTypes");const t=t=>({payload:t,type:e.DASHBOARD.CREATE});exports.createGame=t;const o=()=>({type:e.DASHBOARD.NEXT_ROUND});exports.nextRound=o;const s=t=>({payload:t,type:e.DASHBOARD.SET_ROUNDS});exports.setRounds=s;const r=t=>({payload:t,type:e.DASHBOARD.SET_WINNER});exports.setWinner=r;
},{"./actionTypes":"e0q/"}],"UNuS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setState=exports.endSession=void 0;var e=require("./actionTypes");const t=()=>({type:e.GLOBAL.RESET});exports.endSession=t;const s=t=>({payload:t,type:e.GLOBAL.SET_STATE});exports.setState=s;
},{"./actionTypes":"e0q/"}],"TTXU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updatePoints=exports.setKnockoutPoints=exports.playerEliminated=exports.joinGame=void 0;var t=require("./actionTypes");const e=e=>({payload:e,type:t.PLAYER.JOIN});exports.joinGame=e;const o=e=>({payload:e,type:t.PLAYER.ELIMINATED});exports.playerEliminated=o;const p=(e,o)=>({payload:{id:e,points:o},type:t.PLAYER.SET_KNOCKOUT_POINTS});exports.setKnockoutPoints=p;const s=(e,o)=>({payload:{id:e,points:o},type:t.PLAYER.UPDATE_POINTS});exports.updatePoints=s;
},{"./actionTypes":"e0q/"}],"R9Rd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./dashboardActions")),r=o(require("./globalActions")),t=o(require("./playerActions"));function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};o.get||o.set?Object.defineProperty(r,t,o):r[t]=e[t]}return r.default=e,r}function n(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(r){c(e,r,t[r])})}return e}function c(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const i=n({},e,r,t);var u=i;exports.default=u;
},{"./dashboardActions":"WjlH","./globalActions":"UNuS","./playerActions":"TTXU"}],"pIes":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("../actions/actionTypes");function r(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.forEach(function(r){n(e,r,t[r])})}return e}function n(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}const t={currentRound:0,gameID:null,players:[],rounds:[],winner:null},a=(n=t,a)=>{if(!a)return t;switch(a.type){case e.GLOBAL.RESET:return t;case e.DASHBOARD.CREATE:return r({},n,{gameID:a.payload||null});case e.DASHBOARD.SET_ROUNDS:return r({},n,{currentRound:0,rounds:a.payload||[]});case e.DASHBOARD.NEXT_ROUND:return r({},n,{currentRound:n.currentRound+1});case e.DASHBOARD.SET_WINNER:return r({},n,{winner:a.payload?a.payload.id:null});case e.PLAYER.JOIN:return a.payload&&a.payload.id?n.gameID!==a.payload.gameID?n:r({},n,{players:[...n.players,a.payload.id]}):n;default:return n}};var u=a;exports.default=u;
},{"../actions/actionTypes":"e0q/"}],"Ck1l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("../actions/actionTypes");function t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){r(e,t,n[t])})}return e}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const n=(r=[],n)=>{if(!n)return r;switch(n.type){case e.GLOBAL.RESET:return[];case e.PLAYER.JOIN:return[...r,t({},n.payload,{eliminated:!1,points:0})];case e.PLAYER.UPDATE_POINTS:return r.map(e=>{const r=t({},e);return n.payload&&e.id===n.payload.id&&(r.points+=n.payload.points?parseInt(n.payload.points,10):0),r});case e.PLAYER.ELIMINATED:return r.map(e=>{const r=t({},e);return n.payload&&e.id===n.payload.id&&(r.eliminated=!0),r});case e.PLAYER.SET_KNOCKOUT_POINTS:return r.map(e=>{const r=t({},e);return n.payload&&e.id===n.payload.id&&(r.points=n.payload.points?parseInt(n.payload.points,10):0),r});default:return r}};var a=n;exports.default=a;
},{"../actions/actionTypes":"e0q/"}],"Smdq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t={IDLE:"idle-state",LOBBY:"lobby-state",INTRO:"intro-state",ROUND:"round-state",LADDER:"ladder-state",KNOCKOUT:"knockout-state",WINNER:"winner-state"};exports.default=t;
},{}],"9zsV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("../actions/actionTypes"),t=r(require("../../../../constants/states"));function r(e){return e&&e.__esModule?e:{default:e}}const u=(r=t.default.IDLE,u)=>{if(!u)return r;switch(u.type){case e.GLOBAL.RESET:return t.default.IDLE;case e.GLOBAL.SET_STATE:return u.payload||t.default.IDLE;default:return r}};var a=u;exports.default=a;
},{"../actions/actionTypes":"e0q/","../../../../constants/states":"Smdq"}],"1pvF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("redux"),r=d(require("./dashboardReducer")),t=d(require("./playerReducer")),u=d(require("./stateReducer"));function d(e){return e&&e.__esModule?e:{default:e}}const a=(0,e.combineReducers)({activeState:u.default,dashboard:r.default,players:t.default});var s=a;exports.default=s;
},{"./dashboardReducer":"pIes","./playerReducer":"Ck1l","./stateReducer":"9zsV"}],"w7VJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.actions=exports.store=void 0;var e=require("redux"),r=o(require("./actions/mainActionCreator")),t=o(require("./reducers/mainReducer"));function o(e){return e&&e.__esModule?e:{default:e}}const s=(0,e.createStore)(t.default);exports.store=s;const i=(0,e.bindActionCreators)(r.default,s.dispatch);exports.actions=i;
},{"./actions/mainActionCreator":"R9Rd","./reducers/mainReducer":"1pvF"}],"zX29":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNearestPowerOf2=exports.generateID=exports.digit=void 0;const e=()=>Math.round(9*Math.random());exports.digit=e;const t=()=>`${Math.round(Date.now()*(9999999*Math.random()+1))}`.substring(0,16);exports.generateID=t;const r=e=>e<=0?0:1<<31-Math.clz32(e);exports.getNearestPowerOf2=r;
},{}],"WcRU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateRounds=exports.generateKnockoutLadder=exports.generateGame=exports.calculateTotalRounds=void 0;var e=require("./math-utils");const t=(e,t)=>{let r=0,o=0,n=e;if(e<t||e<=0||t<1||"number"!=typeof e||"number"!=typeof t)return r;for(;0!==n;)n=t*(o+=1)%e;for(;r<3;)r+=o;return r};exports.calculateTotalRounds=t;const r=()=>`${(0,e.digit)()}${(0,e.digit)()}${(0,e.digit)()}${(0,e.digit)()}`;exports.generateGame=r;const o=(e,t,r)=>{const o=[];let n,s,u=[...r];for(let d=0;d<t;d+=1)n=(s=e.filter(e=>-1===u.indexOf(e)&&-1===o.indexOf(e)))[Math.round(Math.random()*(s.length-1))],o.push(n),u=u.length+1===e.length?[]:[...u,n];return{round:o,used:u}},n=(e,r)=>{const n=t(e.length,r),s=[];let u=[];for(let t=0;t<n;t+=1){const{used:t,round:n}=o(e,r,u);s.push(n),u=t}return s},s=(t,r)=>{const o=r.filter(e=>-1!==t.indexOf(e.id)&&!e.eliminated).sort((e,t)=>t.points-e.points).map(e=>e.id),n=(0,e.getNearestPowerOf2)(o.length),s=o.slice(0,n),u=[];let d=0;for(let e=0;e<n/2;e+=1)u.push([s[d],s[s.length-d-1]]),d+=1;return u};exports.generateKnockoutLadder=s;const u=e=>n(e,4);exports.generateRounds=u;
},{"./math-utils":"zX29"}],"v0Wr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.playerJoins=exports.endGame=exports.showWinner=exports.nextKnockout=exports.startKnockout=exports.createLadder=exports.nextRound=exports.startRound=exports.startGame=exports.openLobby=void 0;var t=require("../state/store"),e=require("./game-utils"),o=require("./math-utils"),n=s(require("../../../constants/states"));function s(t){return t&&t.__esModule?t:{default:t}}function a(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),n.forEach(function(e){r(t,e,o[e])})}return t}function r(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const c=()=>{t.actions.createGame((0,e.generateGame)()),t.actions.setState(n.default.LOBBY)};exports.openLobby=c;const i=()=>{t.actions.setRounds((0,e.generateRounds)(t.store.getState().dashboard.players)),t.actions.setState(n.default.INTRO)};exports.startGame=i;const u=()=>{t.actions.setState(n.default.ROUND)};exports.startRound=u;const d=()=>{t.actions.nextRound(),t.actions.setState(n.default.ROUND)};exports.nextRound=d;const l=()=>{const{dashboard:o,players:s}=t.store.getState(),a=(0,e.generateKnockoutLadder)(o.players,s);t.actions.setRounds(a),s.filter(t=>-1===a.flat().indexOf(t.id)).forEach(t.actions.playerEliminated),t.actions.setState(n.default.LADDER)};exports.createLadder=l;const p=()=>{t.actions.setState(n.default.KNOCKOUT)};exports.startKnockout=p;const f=()=>{t.actions.nextRound(),t.actions.setState(n.default.KNOCKOUT)};exports.nextKnockout=f;const x=()=>{const{players:e}=t.store.getState();t.actions.setWinner(e.find(t=>!t.eliminated)),t.actions.setState(n.default.WINNER)};exports.showWinner=x;const b=()=>{t.actions.endSession(),t.actions.setState(n.default.IDLE)};exports.endGame=b;const y=e=>{t.actions.joinGame(a({id:(0,o.generateID)()},e))};exports.playerJoins=y;
},{"../state/store":"w7VJ","./game-utils":"WcRU","./math-utils":"zX29","../../../constants/states":"Smdq"}],"oiLR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SERVER=exports.PLAYER=exports.DASHBOARD=void 0;const e={END_GAME:"dashboard:end-game",NEXT_KNOCKOUT:"dashboard:next-knockout",NEXT_ROUND:"dashboard:next-round",OPEN_LOBBY:"dashboard:open-lobby",START_GAME:"dashboard:start-game",START_KNOCKOUT:"dashboard:start-knockout",START_ROUND:"dashboard:start-round"};exports.DASHBOARD=e;const r={JOIN:"player:join-game"};exports.PLAYER=r;const o={HEARTBEAT:"server:heartbeat",PLAYER_JOINS:"server:player-joins",STATE:"server:state"};exports.SERVER=o;
},{}],"/Mdp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateEliminated=exports.setRoundPoints=void 0;var t=require("../state/store");const e=e=>{e.forEach(t.actions.updatePoints)};exports.setRoundPoints=e;const o=e=>{const{dashboard:o}=t.store.getState(),s=o.rounds[o.currentRound].find(t=>t!==e);t.actions.setKnockoutPoints(s,o.rounds.length-o.currentRound),t.actions.playerEliminated(t.store.getState().players.find(t=>t.id===e))};exports.updateEliminated=o;
},{"../state/store":"w7VJ"}],"tP4h":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PORT=exports.HOST=void 0;const e=process.env.PORT?"king-croak-tournament.herokuapp.com":"127.0.0.1";exports.HOST=e;const o=3e3|process.env.PORT;exports.PORT=o;
},{}],"4nCd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=d(require("../util/state-utils")),t=require("../../../constants/events"),r=require("../util/player-utils"),s=require("../../../constants/settings"),a=i(require("../../../constants/states")),n=require("../state/store"),o=i(require("ws"));function i(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};s.get||s.set?Object.defineProperty(t,r,s):t[r]=e[r]}return t.default=e,t}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c{constructor(s){u(this,"server",void 0),u(this,"previousState",void 0),u(this,"handleStoreChange",()=>{const{activeState:e}=n.store.getState();this.previousState===e&&e!==a.default.ROUND&&e!==a.default.KNOCKOUT||(this.previousState=e,this.send(t.SERVER.STATE,n.store.getState()))}),u(this,"handleConnection",e=>{this.send(t.SERVER.HEARTBEAT,n.store.getState()),e.on("message",this.handleSocketMessage)}),u(this,"handleSocketMessage",s=>{if(!s)return;const{event:o,data:i}=JSON.parse(s),{activeState:d}=n.store.getState();switch(o){case t.DASHBOARD.OPEN_LOBBY:e.openLobby();break;case t.DASHBOARD.START_GAME:e.startGame();break;case t.DASHBOARD.START_ROUND:e.startRound();break;case t.DASHBOARD.NEXT_ROUND:(0,r.setRoundPoints)(i),n.store.getState().dashboard.currentRound<n.store.getState().dashboard.rounds.length-1?e.nextRound():e.createLadder();break;case t.DASHBOARD.START_KNOCKOUT:e.startKnockout();break;case t.DASHBOARD.NEXT_KNOCKOUT:(0,r.updateEliminated)(i),n.store.getState().dashboard.currentRound<n.store.getState().dashboard.rounds.length-1?e.nextKnockout():1!==n.store.getState().players.filter(e=>!e.eliminated).length?e.createLadder():e.showWinner();break;case t.DASHBOARD.END_GAME:e.endGame();break;case t.PLAYER.JOIN:d===a.default.LOBBY&&(e.playerJoins(i),this.send(t.SERVER.PLAYER_JOINS,n.store.getState()))}}),this.server=new o.default.Server({server:s.server}),this.server.on("connection",this.handleConnection),this.previousState=n.store.getState().activeState,n.store.subscribe(this.handleStoreChange)}send(e,t){this.server.clients.forEach(r=>{r.send(JSON.stringify({data:t,event:e}))})}}var l=c;exports.default=l;
},{"../util/state-utils":"v0Wr","../../../constants/events":"oiLR","../util/player-utils":"/Mdp","../../../constants/settings":"tP4h","../../../constants/states":"Smdq","../state/store":"w7VJ"}],"Focm":[function(require,module,exports) {
"use strict";var e=c(require("http")),r=a(require("body-parser")),t=a(require("compression")),s=a(require("cors")),u=a(require("express")),o=require("./constants/paths"),i=a(require("./sockets/WebSocketServer"));function a(e){return e&&e.__esModule?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};s.get||s.set?Object.defineProperty(r,t,s):r[t]=e[t]}return r.default=e,r}const d=(0,u.default)(),n=e.createServer(d),l=process.env.PORT||3e3;d.use((0,s.default)({methods:["GET","POST"],origin:"*"})),d.use((0,t.default)()),d.use(r.default.json()),d.use(r.default.urlencoded({extended:!0})),d.use("/",u.default.static(`${o.ROOT_PATH}/build/dashboard`,{redirect:!0})),d.use("/player",u.default.static(`${o.ROOT_PATH}/build/player`,{redirect:!0})),d.use("/static",u.default.static(`${o.ROOT_PATH}/static`,{redirect:!0})),d.set("port",l),n.listen(l,()=>console.log("SERVER: ready on port",l)),new i.default({server:n});
},{"./constants/paths":"69WS","./sockets/WebSocketServer":"4nCd"}]},{},["Focm"], null)